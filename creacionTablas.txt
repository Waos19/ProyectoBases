-- ==========================================
-- TABLAS BASE
-- ==========================================

-- Miembro
CREATE TABLE Miembro (
  id_miembro NUMBER PRIMARY KEY,
  nombre VARCHAR2(50) NOT NULL
);

-- Estudiante
CREATE TABLE Estudiante (
  id_miembro NUMBER PRIMARY KEY,
  carrera VARCHAR2(50) NOT NULL,
  FOREIGN KEY (id_miembro) REFERENCES Miembro(id_miembro)
);

-- Administrativo
CREATE TABLE Administrativo (
  id_miembro NUMBER PRIMARY KEY,
  cargo VARCHAR2(50) NOT NULL,
  FOREIGN KEY (id_miembro) REFERENCES Miembro(id_miembro)
);

-- Docente
CREATE TABLE Docente (
  id_miembro NUMBER PRIMARY KEY,
  departamento VARCHAR2(50) NOT NULL,
  FOREIGN KEY (id_miembro) REFERENCES Miembro(id_miembro)
);

-- Instructor
CREATE TABLE Instructor (
  id_instructor NUMBER PRIMARY KEY,
  nombre VARCHAR2(50) NOT NULL,
  especialidad VARCHAR2(50) NOT NULL
);

-- ==========================================
-- ACTIVIDAD (PADRE + ESPECIALIZACIÓN)
-- ==========================================

CREATE TABLE Actividad (
  id_actividad NUMBER PRIMARY KEY,
  horario VARCHAR2(50) NOT NULL,
  cupos_maximos NUMBER NOT NULL,
  id_instructor NUMBER NOT NULL,
  tipo_actividad VARCHAR2(20) NOT NULL,
  CONSTRAINT fk_actividad_instructor FOREIGN KEY (id_instructor)
    REFERENCES Instructor(id_instructor),
  CONSTRAINT chk_tipo_actividad CHECK (tipo_actividad IN ('Deporte','Gimnasio','Musica','Orientacion'))
);

-- Tablas hijas (especialización)
CREATE TABLE Deporte (
  id_actividad NUMBER PRIMARY KEY,
  tipo_deporte VARCHAR2(30) NOT NULL,
  FOREIGN KEY (id_actividad) REFERENCES Actividad(id_actividad)
);

CREATE TABLE Gimnasio (
  id_actividad NUMBER PRIMARY KEY,
  numero_sesiones NUMBER NOT NULL,
  FOREIGN KEY (id_actividad) REFERENCES Actividad(id_actividad)
);

CREATE TABLE Musica (
  id_actividad NUMBER PRIMARY KEY,
  tipo_instrumento VARCHAR2(30) NOT NULL,
  FOREIGN KEY (id_actividad) REFERENCES Actividad(id_actividad)
);

CREATE TABLE Orientacion_Personal (
  id_actividad NUMBER PRIMARY KEY,
  tipo_orientacion VARCHAR2(30) NOT NULL,
  FOREIGN KEY (id_actividad) REFERENCES Actividad(id_actividad)
);

CREATE TABLE Pago_Gimnasio (
  id_pago NUMBER PRIMARY KEY,
  id_miembro NUMBER NOT NULL,
  id_actividad NUMBER NOT NULL,
  fecha_pago DATE NOT NULL,
  sesiones_extra NUMBER DEFAULT 0,
  monto NUMBER NOT NULL,
  FOREIGN KEY (id_miembro) REFERENCES Miembro(id_miembro),
  FOREIGN KEY (id_actividad) REFERENCES Gimnasio(id_actividad)
);
